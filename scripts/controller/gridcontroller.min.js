define(function(require){function r(){n.addClues(o.lines),n.showUrl(s.generateUrl())}var o,s=require("../model/grid.min"),n=require("../view/xword.min");return document.getElementById("finish").addEventListener("click",function(){n.getRidOfGrid(),o.addNumbersToSquares(),n.addNumbers(o),n.getClues(o.lines),document.getElementById("finish").style.display="none"}),document.getElementById("generate").addEventListener("click",function(){n.hideCluesGetter(),s.saveClues(),r()}),document.getElementById("save-for-later").addEventListener("click",function(){document.location.href="mailto:?body="+s.generateUrl(!0)+"&subject= My saved crossword"}),{addLine:function(e,r,s){o.addLine(e,r,s),n.drawCrossword(o)},start:function(){if(document.URL.split("?xword=")[1]){var e=s.getObjectFromUrl(Document.URL);return e.viewProperties=s.getViewProperties(),e.viewProperties.HEIGHT=e.stageHeight,e.viewProperties.WIDTH=e.stageWidth,n.makeStage(s.getViewProperties()),o=e,document.getElementById("save-for-later").style.display="block",void n.drawEmptyCrossword(e)}document.getElementById("finish").style.display="block",n.makeStage(s.getViewProperties()),o=s.get(),n.setController(this),n.draw(o)}}});